# CPRG-306 Week 13

# ORM and Middleware

---

## Topics

- ORM
- Middleware
- Starter Templates

---

## ORM

- Object-Relational Mapping
- A programming technique for converting data between incompatible type systems using object-oriented programming languages
- Eliminates the need for most of the data-access code that developers usually need to write

---

## Prisma

- ORM for Node.js and TypeScript
- **Prisma Client**: Auto-generated and type-safe query builder for Node.js & TypeScript.
- **Prisma Migrate**: Declarative data modeling & migration system.

---

## Key Features of Prisma

- **Strongly Typed API**: TypeScript for safer and more reliable code.
- **Auto-Completion**: Auto-completion for your database queries.
- **Declarative Migrations**: Define your database schema and let Prisma Migrate handle the changes.
- **Support for Many Databases**: Compatible with PostgreSQL, MySQL, SQL Server, SQLite, and more.

---

## Middleware

- a function that runs before the main route handler.
- have access to the request and response objects.
- can perform the following tasks:
  - Execute any code.
  - Make changes to the request and the response objects.
  - End the request-response cycle.

---

## Common Uses of Middleware

- Authentication and Authorization
- Logging
- Path Rewriting
- Bot Detection
- Server-Side Redirects, e.g. locale, role-based routing

---

## Middleware in Next.js

- implemented with `middleware.ts` (or `middleware.js`)
- `redirect` function to redirect to a different URL (HTTP status code 307)
- `rewrite` function to rewrite the URL

---

## Starter Templates

- https://vercel.com/templates/next.js
- https://t3.gg/
- https://nextra.site/

---

## Coding Demo

- Replace SQL with ORM
- Implement middleware.ts to redirect and rewrite URLs
